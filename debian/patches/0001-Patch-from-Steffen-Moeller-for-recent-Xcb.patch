>From d8e6277f152c42464f1c23683a575d5826a45bbc Mon Sep 17 00:00:00 2001
From: Bernd Machenschalk <bernd.machenschalk@ligo.org>
Date: Mon, 21 May 2012 16:35:57 +0200
Subject: [PATCH 1/2] Patch from Steffen Moeller for recent Xcb

---
 clientscr/screensaver_x11.cpp |   14 +++++++++-----
 1 file changed, 9 insertions(+), 5 deletions(-)

diff --git a/clientscr/screensaver_x11.cpp b/clientscr/screensaver_x11.cpp
index a2e2649..8f6a9a4 100644
--- a/clientscr/screensaver_x11.cpp
+++ b/clientscr/screensaver_x11.cpp
@@ -531,10 +531,14 @@ int main(int argc, char *argv[])
   for(int n = 0; n < 10; n++)
     {
       // get list of x clients
-      xcb_atom_t NET_CLIENT_LIST = xcb_atom_get(con, "_NET_CLIENT_LIST");
+      // xcb_atom_t NET_CLIENT_LIST = xcb_atom_get(con, "_NET_CLIENT_LIST");
+      xcb_intern_atom_cookie_t cookie0=xcb_intern_atom(con, 0, strlen("_NET_CLIENT_LIST"),
+						       "_NET_CLIENT_LIST");
+      xcb_intern_atom_reply_t *reply0=xcb_intern_atom_reply(con, cookie0, NULL);
+
       xcb_get_property_cookie_t cookie =
-        xcb_get_property(con, 0, screen->root, NET_CLIENT_LIST, WINDOW, 0,
-                        std::numeric_limits<uint32_t>::max());
+        xcb_get_property(con, 0, screen->root, reply0->atom, XCB_ATOM_WINDOW, 0,
+			 std::numeric_limits<uint32_t>::max());
 
       xcb_generic_error_t  *error;
       xcb_get_property_reply_t *reply =
@@ -554,7 +558,7 @@ int main(int argc, char *argv[])
           xcb_get_property_reply_t *reply2;
 
           // check WM_COMMAND
-          cookie = xcb_get_property(con, 0, clients[c], WM_COMMAND, STRING,
+          cookie = xcb_get_property(con, 0, clients[c], XCB_ATOM_WM_COMMAND, XCB_ATOM_STRING,
                                     0, std::numeric_limits<uint32_t>::max());
           reply2 = xcb_get_property_reply(con, cookie, &error);
           if(!error) // ignore errors
@@ -571,7 +575,7 @@ int main(int argc, char *argv[])
             }
 
           // check WM_CLASS
-          cookie = xcb_get_property(con, 0, clients[c], WM_CLASS, STRING,
+          cookie = xcb_get_property(con, 0, clients[c], XCB_ATOM_WM_CLASS, XCB_ATOM_STRING,
                                     0, std::numeric_limits<uint32_t>::max());
           reply2 = xcb_get_property_reply(con, cookie, &error);
           if(!error) // ignore errors
-- 
1.7.10.1

